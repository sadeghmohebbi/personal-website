---
title: برخی از رسومات انتقال لاگ های سیستم
description: معرفی و بررسی پروتکل RELP و rsyslog
date: 2024-07-20
tags:
  - linux
  - event logging
draft: true
---
چند وقت پیش در یکی از جلسات tehlug نشسته بودم و آخرین ارائه‌ی نیز در خصوص پیاده سازی logstash و ذخیره سازی لاگ ها در الستیک سرچ بود تا با kibana بتوان روی آن کوئری زد و داشبورد ساخت. یکی از حاظران در زمان پرسش و پاسخ انتهای جلسه ابتدا از معایب انتقال لاگ بر بستر HTTP گفت و سپس به RELP اشاره کرد که به عنوان یک پروتکل انتقال لاگ (به جای fluentd یا logstash یا promtail) قابل استفاده است. از آن موقع که حدود ۴ ماه گذشته، گوشه‌ی ذهنم در خصوص کارکرد RELP سوالات زیادی بود و تحقیقاتی نیز کردم. در ادامه‌ی این مقاله با ذوق زدگی از تعاریف و کارکرد ها تا اجرای یک پروژه‌ی عملی براتون می‌گم. {.rtl}

> Please welcome RELP, the “reliable event logging protocol”.

## فلسفه‌ی چیستی و چرایی وجود {.rtl}

به طور کلی پروتکل RELP یا مخفف reliable event logging protocol روشی است برای انتقال لاگ ایونت های سیستم و نرم افزار بر بستر شبکه که می تواند با سرعت زیاد و در مقیاس و اتکاپذیری بالا به خوبی عمل کند. به گفته‌ی خالق RELP ، ایجاد این ابزار به علت نواقصی بود که rsyslog پوشش نمی داد و در دنیای ابری امروز قابل استفاده نبود و RELP بر اساس rsyslog توسعه یافته است. پس در اینجا لازم است ابتدا نگاهی به کاربرد و نواقص rsyslog بیاندازیم. {.rtl}

البته در پرانتز اشاره ای کنم به این موضوع که rsyslog شاخه‌ ایست از syslogd سال ۲۰۰۴ که در این سال ها توسعه پیدا کرده و در عمده‌ی توزیع های لینوکس جایگزین syslogd قدیمی شده است. اینکه syslogd BSD چه بوده و چه فرایند و تاریخچه ای طی کرده تا به rsyslog رسیده بماند! در انتهای این نوشته حتما منابعی را برای مراجعه قرار خواهم داد. {.rtl}

برای مطالعه جزئیات پروتکل syslog پیشنهاد می‌کنم که حتما نگاهی به [RFC5424](https://datatracker.ietf.org/doc/html/rfc5424) بیاندازید ولی در ادامه با همدیگه مروری سریع روی آن خواهیم داشت. {.rtl}

اگر در پروتکل http ما مفاهیمی مثل client و server و proxy داریم، در syslog نیز مفاهیم مشابه ای وجود دارد: {.rtl}

1. content
2. syslog application -> originator , collector , rely
3. syslog transport -> transport sender or receiver

لایه‌ی اول محتوای پیامی است که قرار است نوشته و ضبط شود. لایه‌ی دوم برنامه هایی  هستند که عملا آن پیام را می نویسند یا می خوانند و لایه‌ی سوم صرفا پیام را روی شبکه منتقل می‌کند. {.rtl}

